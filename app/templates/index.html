{% extends "base.html" %}

{% block content %}
<div class="container">
    <h1><span class="music-icon">ðŸŽµ</span>Welcome to MAPP<span class="music-icon">ðŸŽµ</span></h1>
    <div class="subheading-container">
        <h2>Music Analysis and Pattern Prediction</h2>
        <h3>To help you find your way!</h3>
    </div>
    <div class="animated-text-container">
        <div class="animated-text">
            <p>Unleash the power of AI to analyze your music and gain valuable insights. Perfect for musicians, artists, songwriters, and producers.</p>
            <p>Find out your hit potential by seeing how your song compares to artists whose songs chart on popular charts like Billboard Hot 100!</p>
            <p>Get realtime analytics that show your track's strengths and areas where you could benefit from constructive criticism.</p>
            <p>Get insightful, easy to read charts and have our dynamic AI-powered system provide suggestions for your song's structure, lyrics, and songwriting techniques.</p>
            <p>We know how hard you work so, why not let us clear the path to help you find your way?</p>
        </div>
    </div>
    
    <div class="upload-section" style="max-width: 500px; margin: 0 auto;">
        <h2>Upload Your Track</h2>
        <form id="analysis-form" action="{{ url_for('api.analyze_song') }}" method="post" enctype="multipart/form-data">
            <input type="file" name="file" accept=".mp3,.wav" required>
            <input type="text" name="title" placeholder="Song Title" required>
            <input type="text" name="artist" placeholder="Artist" required>
            <select name="year" required style="display: block; width: 103%; height: 35px; padding: 8px; margin-bottom: 10px; border: 1px solid #64ffda; border-radius: 4px; background: rgba(255, 255, 255, 0.1); color: #e0e0e0;">
                {% for year in range(current_year, current_year - 6, -1) %}
                    <option value="{{ year }}">{{ year }}</option>
                {% endfor %}
            </select>
            <input type="text" name="producer" placeholder="Producer">
            <button type="submit" style="display: block; width: calc(103%); margin: 0 -1px;">Analyze Track</button>
        </form>
    </div>
</div>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        const animatedText = document.querySelector('.animated-text');
        
        function resetAnimation() {
            animatedText.style.animation = 'none';
            animatedText.offsetHeight;
            animatedText.style.animation = null;
        }

        animatedText.addEventListener('animationiteration', resetAnimation);

        {% if not current_user.is_authenticated %}
            const form = document.getElementById('analysis-form');
            const inputs = form.querySelectorAll('input, select, button');
            
            // Create a more elegant overlay
            const overlay = document.createElement('div');
            overlay.style.cssText = `
                position: absolute;
                top: 0;
                left: 0;
                right: 0;
                bottom: 0;
                background: rgba(13, 25, 48, 0.95);
                display: flex;
                flex-direction: column;
                justify-content: center;
                align-items: center;
                border-radius: 8px;
                z-index: 10;
                backdrop-filter: blur(4px);
                border: 1px solid rgba(100, 255, 218, 0.2);
                box-shadow: 0 8px 32px rgba(31, 38, 135, 0.37);
                transition: all 0.3s ease;
            `;
            
            // Create a more stylish message container
            const messageContainer = document.createElement('div');
            messageContainer.style.cssText = `
                background: rgba(100, 255, 218, 0.1);
                padding: 30px;
                border-radius: 8px;
                border: 1px solid #64ffda;
                text-align: center;
                max-width: 80%;
            `;
            
            // Add icon
            const icon = document.createElement('div');
            icon.style.cssText = `
                font-size: 2.5em;
                color: #64ffda;
                margin-bottom: 15px;
                text-shadow: 0 0 10px rgba(100, 255, 218, 0.5);
            `;
            icon.textContent = 'ðŸ”’';
            
            // Style the message text
            const message = document.createElement('div');
            message.style.cssText = `
                color: #64ffda;
                font-family: 'Orbitron', sans-serif;
                font-size: 1.2em;
                margin-bottom: 20px;
                text-shadow: 0 0 10px rgba(100, 255, 218, 0.3);
            `;
            message.textContent = 'Please log in or create an account to analyze songs';
            
            // Add stylish buttons
            const buttonContainer = document.createElement('div');
            buttonContainer.style.cssText = `
                display: flex;
                gap: 15px;
                margin-top: 20px;
                justify-content: center;
                width: 100%;
            `;
            
            const loginButton = document.createElement('a');
            loginButton.href = "{{ url_for('auth.login') }}";
            loginButton.style.cssText = `
                padding: 10px 20px;
                background: rgba(100, 255, 218, 0.1);
                border: 1px solid #64ffda;
                border-radius: 4px;
                color: #64ffda;
                text-decoration: none;
                font-family: 'Orbitron', sans-serif;
                transition: all 0.3s ease;
            `;
            loginButton.textContent = 'Login';
            loginButton.onmouseover = () => loginButton.style.background = 'rgba(100, 255, 218, 0.2)';
            loginButton.onmouseout = () => loginButton.style.background = 'rgba(100, 255, 218, 0.1)';
            
            const signupButton = document.createElement('a');
            signupButton.href = "{{ url_for('auth.register') }}";
            signupButton.style.cssText = loginButton.style.cssText;
            signupButton.textContent = 'Sign Up';
            signupButton.onmouseover = () => signupButton.style.background = 'rgba(100, 255, 218, 0.2)';
            signupButton.onmouseout = () => signupButton.style.background = 'rgba(100, 255, 218, 0.1)';
            
            // Assemble the overlay
            messageContainer.appendChild(icon);
            messageContainer.appendChild(message);
            buttonContainer.appendChild(loginButton);
            buttonContainer.appendChild(signupButton);
            messageContainer.appendChild(buttonContainer);
            overlay.appendChild(messageContainer);
            
            // Add to the form
            form.parentElement.style.position = 'relative';
            form.parentElement.appendChild(overlay);
            
            // Disable form elements with style
            inputs.forEach(input => {
                input.disabled = true;
                input.style.opacity = '0.5';
                input.style.cursor = 'not-allowed';
            });
            
            form.addEventListener('submit', function(e) {
                e.preventDefault();
            });
        {% endif %}
    });
</script>
{% endblock %}
